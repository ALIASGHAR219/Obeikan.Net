import { Injectable } from "@angular/core";
import { DEFAULT_DATE_FORMAT, NgxDatetimeRangePickerConstants as Constants } from "./ngx-datetime-range-picker.constants";
import { getNotAvailableText, cloneDeep, isNil } from "./ngx-datetime-range-picker.utils";
import { CalendarTypes } from "./interfaces";
import * as i0 from "@angular/core";
import * as Éµngcc0 from '@angular/core';
const moment = require("moment");
const DEFAULT_TIME_FORMAT = Constants.DEFAULT.TIME_FORMAT;
const MONTHS_AVAILABLE = Constants.CONSTANT.MONTHS_AVAILABLE;
const TZ_NAMES = Constants.CONSTANT.TZ_NAMES;
const DEFAULT_RANGES = Constants.DEFAULT.RANGES;
const MOMENT_CONVERSION_MAP = Constants.CONSTANT.MOMENT_CONVERSION_MAP;
export class NgxDatetimeRangePickerService {
    getDefaultOptions() {
        return cloneDeep(Constants.DEFAULT.OPTIONS);
    }
    getDefaultSettings() {
        return cloneDeep(Constants.DEFAULT.SETTINGS);
    }
    getDefaultState() {
        return cloneDeep(Constants.DEFAULT.STATE);
    }
    checkSettingsValidity(settings) {
        if (settings.type && !CalendarTypes.includes(settings.type)) {
            const errMsg = `${settings.type} is an invalid calendar type. It should one of ${[...CalendarTypes]}`;
            throw new Error(errMsg);
        }
    }
    formatDateToDefaultFormat(date, format) {
        let formattedDate = null;
        if (!date) {
            return;
        }
        if (!isNaN(Number(date))) {
            formattedDate = moment(date).format(DEFAULT_DATE_FORMAT);
        }
        else {
            formattedDate = moment(date, format).format(DEFAULT_DATE_FORMAT);
        }
        return formattedDate;
    }
    formatTimeToDefaultFormat(time) {
        let formattedTime = null;
        if (!time) {
            return;
        }
        if (time.indexOf(":") > -1) {
            if (time.indexOf("AM") > -1 || time.indexOf("PM") > -1) {
                formattedTime = moment(time, "h:mm A").format(DEFAULT_TIME_FORMAT);
            }
            else {
                formattedTime = time;
            }
        }
        else {
            console.warn(`WARN_NGX_DATETIME_RANGE_PICKER:
            The provided time is not in correct format.
            Format: HH:mm or hh:mm A
        `);
        }
        return formattedTime;
    }
    getCalendarRowNumberText(type, number) {
        return (() => {
            switch (type) {
                case "daily":
                    return `W${number}`;
                case "weekly":
                    return "";
                case "monthly":
                    return `Q${number}`;
                case "quarterly":
                    return `${number}`;
                case "yearly":
                    return "";
            }
        })();
    }
    createDefaultRanges(config) {
        const ranges = {};
        const type = config.type;
        const maxDate = cloneDeep(config.maxDate);
        DEFAULT_RANGES[type].forEach((rangeInfo) => {
            ranges[rangeInfo.label] = {
                startDate: moment(maxDate, DEFAULT_DATE_FORMAT)
                    .subtract(rangeInfo.count, MOMENT_CONVERSION_MAP[type])
                    .format(DEFAULT_DATE_FORMAT),
                endDate: maxDate
            };
        });
        ranges["Custom Range"] = { startDate: null, endDate: null };
        return ranges;
    }
    getSanitizedDateArray(config) {
        const sanitizedDateArray = [];
        const type = config.type;
        const dateArray = config.dateArray;
        const inputDateFormat = config.inputDateFormat;
        // dateArray can have nulls
        dateArray.forEach((date) => {
            if (!date) {
                return;
            }
            let format = null;
            if (isNaN(Number(date))) {
                if (inputDateFormat) {
                    format = inputDateFormat;
                }
                else {
                    format = moment(date)._f; // moment does not support this
                }
            }
            if (inputDateFormat !== moment(date)._f) {
                console.warn(`ERR_NGX_DATETIME_RANGE_PICKER:
              inputDateFormat !== dateFormat in dateArray.
              Converted dates might not be as expected
            `);
            }
            const value = format ? moment(date, format) : moment(date);
            if (value) {
                const formattedDate = value.endOf(MOMENT_CONVERSION_MAP[type]).format(DEFAULT_DATE_FORMAT);
                sanitizedDateArray.push(formattedDate);
            }
            else {
                console.warn(`ERR_NGX_DATETIME_RANGE_PICKER:
              dateArray values are in unknown format.
              Pass the format or pass the dates in known format
            `);
            }
        });
        return [...new Set(sanitizedDateArray)];
    }
    getNumberOfWeeks(date) {
        if (!date) {
            return;
        }
        const monthStart = moment(date, DEFAULT_DATE_FORMAT)
            .startOf("month")
            .day();
        const monthEnd = Number(moment(date, DEFAULT_DATE_FORMAT)
            .endOf("month")
            .format("D"));
        return Math.ceil((monthStart + monthEnd) / 7);
    }
    getYearlyWeekCount(year) {
        if (!year) {
            return;
        }
        const yearStartDate = moment(year, "YYYY")
            .startOf("year")
            .format(DEFAULT_DATE_FORMAT);
        const yearEndDate = moment(year, "YYYY")
            .endOf("year")
            .format(DEFAULT_DATE_FORMAT);
        const yearEndWeekEndDate = moment(yearEndDate, DEFAULT_DATE_FORMAT)
            .startOf("week")
            .format(DEFAULT_DATE_FORMAT);
        const yearStartWeekEndDate = moment(yearStartDate, DEFAULT_DATE_FORMAT)
            .endOf("week")
            .format(DEFAULT_DATE_FORMAT);
        const yearStartWeekNumber = this.getWeekNumber(yearStartWeekEndDate);
        const yearEndWeekNumber = this.getWeekNumber(yearEndWeekEndDate);
        return yearEndWeekNumber - yearStartWeekNumber + 1;
    }
    getMonthsAvailable(minDate, maxDate, selectedYear) {
        const months = [];
        if (!minDate || !maxDate || !selectedYear) {
            return;
        }
        minDate = moment(minDate, DEFAULT_DATE_FORMAT).startOf("month");
        maxDate = moment(maxDate, DEFAULT_DATE_FORMAT).startOf("month");
        let minDatems = moment(minDate, DEFAULT_DATE_FORMAT).valueOf();
        let maxDatems = moment(maxDate, DEFAULT_DATE_FORMAT).valueOf();
        const yearStartms = moment()
            .year(selectedYear)
            .startOf("year")
            .valueOf();
        const yearEndms = moment()
            .year(selectedYear)
            .endOf("year")
            .valueOf();
        if (minDatems < yearStartms) {
            minDatems = yearStartms;
        }
        if (maxDatems > yearEndms) {
            maxDatems = yearEndms;
        }
        let minDateMonthNumber = moment(minDatems).month();
        const diff = moment(maxDatems).diff(moment(minDatems), "months");
        const maxMonths = diff < MONTHS_AVAILABLE.length ? diff : MONTHS_AVAILABLE.length;
        for (let i = 0; i <= maxMonths; i++) {
            if (minDateMonthNumber >= MONTHS_AVAILABLE.length) {
                months.push(MONTHS_AVAILABLE[minDateMonthNumber - MONTHS_AVAILABLE.length]);
            }
            else {
                months.push(MONTHS_AVAILABLE[minDateMonthNumber]);
            }
            minDateMonthNumber++;
        }
        return months;
    }
    getYearsAvailable(config) {
        const minDate = config ? config.minDate : "";
        const maxDate = config ? config.maxDate : "";
        const years = [];
        if (minDate && maxDate) {
            const minYear = Number(this.getSelectedYear(minDate));
            const maxYear = Number(this.getSelectedYear(maxDate));
            const diff = maxYear - minYear;
            for (let i = 0; i <= diff; i++) {
                years.push(`${minYear + i}`);
            }
        }
        return years.reverse();
    }
    isDateAvailable(date, minDate, maxDate, startDate, endDate, monthStartDate, monthEndDate, config) {
        let available = false;
        const type = config.type;
        const disableWeekends = config.disableWeekends;
        const disableWeekdays = config.disableWeekdays;
        if (type === "daily") {
            minDate = minDate > monthStartDate ? minDate : monthStartDate;
            maxDate = maxDate < monthEndDate ? maxDate : monthEndDate;
        }
        if (date >= minDate && date <= maxDate) {
            available = true;
            if (available) {
                if (disableWeekends) {
                    available = !this.isWeekend(date);
                }
                if (disableWeekdays) {
                    available = !this.isWeekday(date);
                }
                if (config.dateArray.length) {
                    available = this.isInDateArray(date, config.dateArray, DEFAULT_DATE_FORMAT);
                }
            }
        }
        return available;
    }
    isDateInRange(date, minDate, maxDate, startDate, endDate, monthStartDate, monthEndDate, available, config) {
        let inRange = false;
        const type = config.type;
        const singleDatePicker = config.singleDatePicker;
        if (!singleDatePicker) {
            if (type === "daily") {
                minDate = monthStartDate;
                maxDate = monthEndDate;
            }
            if (date >= startDate && date <= endDate && date >= minDate && date <= maxDate) {
                if (available) {
                    inRange = true;
                }
            }
        }
        return inRange;
    }
    isDateActive(date, startDate, endDate, side) {
        return (date === startDate && side === "left") || (date === endDate && side === "right");
    }
    isDateToday(dateMs, config) {
        const todayDate = moment().format(DEFAULT_DATE_FORMAT);
        const type = config.type;
        const { firstDay, lastDay } = this.getFirstLastDay(todayDate, type);
        const firstDayMs = moment(firstDay, DEFAULT_DATE_FORMAT).valueOf();
        const lastDayMs = moment(lastDay, DEFAULT_DATE_FORMAT).valueOf();
        return dateMs >= firstDayMs && dateMs <= lastDayMs;
    }
    isWeekday(date, format) {
        return !this.isWeekend(date, format);
    }
    isWeekend(date, format) {
        if (!format) {
            format = null;
        }
        const day = moment(date, format).day();
        return day === 0 || day === 6;
    }
    isInDateArray(date, dateArray, format) {
        if (!format) {
            format = null;
        }
        return dateArray.find((d) => moment(d, format).valueOf() === date) !== undefined;
    }
    getCalendarRowVariables(options) {
        const variables = {
            rowNumber: "",
            columns: 0
        };
        const type = options.type;
        const monthStartWeekNumber = options.monthStartWeekNumber;
        const dateRows = options.dateRows;
        const year = `${options.year}`;
        if (type === "daily") {
            variables.rowNumber = `${monthStartWeekNumber + dateRows}`;
            variables.columns = 6;
        }
        else if (type === "weekly") {
            variables.rowNumber = ``;
            variables.columns = 6;
        }
        else if (type === "monthly") {
            variables.rowNumber = `${dateRows + 1}`;
            variables.columns = 2;
        }
        else if (type === "quarterly") {
            variables.rowNumber = year.charAt(dateRows);
            variables.columns = 0;
        }
        else if (type === "yearly") {
            variables.rowNumber = "";
            variables.columns = 0;
        }
        return variables;
    }
    getCalendarRowItemVariables(options) {
        const { type, monthStartWeekNumber, yearStartDate, year, rowItem, dateRows, columns } = options;
        const itemCount = rowItem + dateRows * columns + dateRows;
        let currentItemDate = "";
        let rowItemText = "";
        if (type === "daily") {
            if (!isNil(monthStartWeekNumber) && !isNil(dateRows) && !isNil(year)) {
                const yearStartDateDaily = moment()
                    .year(year)
                    .startOf("year")
                    .format(DEFAULT_DATE_FORMAT);
                currentItemDate = moment(yearStartDateDaily, DEFAULT_DATE_FORMAT)
                    .add(monthStartWeekNumber + dateRows - 1, "week")
                    .startOf("week")
                    .add(rowItem, "day")
                    .format(DEFAULT_DATE_FORMAT);
                rowItemText = moment(currentItemDate, DEFAULT_DATE_FORMAT).format("D");
            }
        }
        else if (type === "weekly") {
            if (!isNil(yearStartDate) && !isNil(itemCount)) {
                currentItemDate = moment(yearStartDate, DEFAULT_DATE_FORMAT)
                    .add(itemCount, "week")
                    .endOf("week")
                    .format(DEFAULT_DATE_FORMAT);
                const weekNumber = itemCount + 1;
                rowItemText = `W${weekNumber}`;
            }
        }
        else if (type === "monthly") {
            if (!isNil(itemCount) && !isNil(year)) {
                currentItemDate = moment()
                    .year(year)
                    .month(itemCount)
                    .endOf("month")
                    .format(DEFAULT_DATE_FORMAT);
                rowItemText = moment(currentItemDate, DEFAULT_DATE_FORMAT).format("MMM");
            }
        }
        else if (type === "quarterly") {
            if (!isNil(itemCount) && !isNil(year)) {
                currentItemDate = moment()
                    .year(year)
                    .quarter(itemCount + 1)
                    .endOf("quarter")
                    .format(DEFAULT_DATE_FORMAT);
                rowItemText = `Quarter ${itemCount + 1}`;
            }
        }
        const { firstDay, lastDay } = this.getFirstLastDay(currentItemDate, type);
        return {
            itemCount,
            currentItemDate,
            rowItemText,
            firstDay,
            lastDay
        };
    }
    isRowIemValid(options) {
        let valid = false;
        const type = options.type;
        const year = options.year;
        const itemCount = options.itemCount;
        const validWeekCount = this.getYearlyWeekCount(year);
        if (type === "daily") {
            valid = true;
        }
        else if (type === "weekly") {
            if (itemCount < validWeekCount) {
                valid = true;
            }
        }
        else if (type === "monthly") {
            valid = true;
        }
        else if (type === "quarterly") {
            valid = true;
        }
        return valid;
    }
    formatStartDate(config, returnFormat) {
        const startDate = config ? config.startDate : null;
        const type = config ? config.type : "";
        let formattedStartDate = null;
        if (startDate) {
            formattedStartDate = moment(startDate, DEFAULT_DATE_FORMAT)
                .startOf(MOMENT_CONVERSION_MAP[type])
                .format(returnFormat);
        }
        return formattedStartDate;
    }
    getSelectedYear(date) {
        return moment(date, DEFAULT_DATE_FORMAT).format("YYYY");
    }
    getFirstLastDay(date, type) {
        let firstDay = "";
        let lastDay = "";
        if (type === "daily") {
            firstDay = lastDay = date;
        }
        else if (type === "weekly") {
            firstDay = moment(date, DEFAULT_DATE_FORMAT)
                .startOf("week")
                .format(DEFAULT_DATE_FORMAT);
            lastDay = moment(date, DEFAULT_DATE_FORMAT)
                .endOf("week")
                .format(DEFAULT_DATE_FORMAT);
        }
        else if (type === "monthly") {
            firstDay = moment(date, DEFAULT_DATE_FORMAT)
                .startOf("month")
                .format(DEFAULT_DATE_FORMAT);
            lastDay = moment(date, DEFAULT_DATE_FORMAT)
                .endOf("month")
                .format(DEFAULT_DATE_FORMAT);
        }
        else if (type === "quarterly") {
            firstDay = moment(date, DEFAULT_DATE_FORMAT)
                .startOf("quarter")
                .format(DEFAULT_DATE_FORMAT);
            lastDay = moment(date, DEFAULT_DATE_FORMAT)
                .endOf("quarter")
                .format(DEFAULT_DATE_FORMAT);
        }
        else if (type === "yearly") {
            firstDay = moment(date, DEFAULT_DATE_FORMAT)
                .startOf("year")
                .format(DEFAULT_DATE_FORMAT);
            lastDay = moment(date, DEFAULT_DATE_FORMAT)
                .endOf("year")
                .format(DEFAULT_DATE_FORMAT);
        }
        return { firstDay, lastDay };
    }
    getZoneDate(tz, format, date) {
        let _date = moment().valueOf();
        if (date) {
            _date = moment(date, format)
                .startOf("day")
                .valueOf();
        }
        const today = new Date(_date).toLocaleString("en-US", {
            timeZone: TZ_NAMES[tz]
        });
        return moment(today, "MM/DD/YYYY, hh:mm:ss A");
    }
    getZoneToday(tz, viewDateFormat) {
        const today = this.getZoneDate(tz, viewDateFormat);
        return moment(today).format(`${viewDateFormat}  hh:mm A`);
    }
    formatToZoneDate(tz, format, date) {
        const formattedDate = this.getZoneDate(tz, format, date);
        return moment(formattedDate).format(`${format}`);
    }
    convertToViewTimeItem(item) {
        let stringified_item = item + "";
        if (stringified_item.length === 1) {
            stringified_item = `0${stringified_item}`;
        }
        return stringified_item;
    }
    getWeekNumber(date) {
        if (date) {
            const year = moment(date, "YYYY-MM-DD").year();
            const month = moment(date, "YYYY-MM-DD").month();
            const day = Number(moment(date, "YYYY-MM-DD").format("D"));
            const yearStartms = new Date(year, 0, 1);
            const datems = new Date(year, month, day);
            return Math.ceil(((datems.getTime() - yearStartms.getTime()) / 86400000 + yearStartms.getDay() + 1) / 7);
        }
        else {
            console.warn(`
        WARN_NGX_DATETIME_RANGE_PICKER | getWeekNumber:
        Invalid date
      `);
            return getNotAvailableText();
        }
    }
    iterateOverDateObj(dates, func) {
        for (const side in dates) {
            if (side) {
                const sideDates = dates[side];
                sideDates.itemRows.forEach((rows) => {
                    rows.items.forEach((rowItem) => {
                        func(rowItem);
                    });
                });
            }
        }
    }
    getCalendarColspan(type) {
        if (type === "daily") {
            return 6;
        }
        else if (type === "weekly") {
            return 8;
        }
        else if (type === "monthly") {
            return 3;
        }
        else if (type === "quarterly") {
            return 1;
        }
        else if (type === "yearly") {
            return 1;
        }
    }
    getCalendarRowItemColspan(type) {
        if (type === "monthly") {
            return 3;
        }
        else if (type === "quarterly") {
            return 6;
        }
        else if (type === "yearly") {
            return 6;
        }
    }
    getDateCharacteristics(config, state, date, month, side) {
        const currentDate = moment(date, DEFAULT_DATE_FORMAT)
            .startOf("day")
            .valueOf();
        let _date = this.formatDateToDefaultFormat(config.minDate, DEFAULT_DATE_FORMAT);
        const minDate = moment(_date, DEFAULT_DATE_FORMAT)
            .startOf("day")
            .valueOf();
        _date = this.formatDateToDefaultFormat(config.maxDate, DEFAULT_DATE_FORMAT);
        const maxDate = moment(_date, DEFAULT_DATE_FORMAT)
            .startOf("day")
            .valueOf();
        _date = this.formatDateToDefaultFormat(config.startDate, DEFAULT_DATE_FORMAT);
        const startDate = moment(_date, DEFAULT_DATE_FORMAT)
            .startOf("day")
            .valueOf();
        _date = this.formatDateToDefaultFormat(config.endDate, DEFAULT_DATE_FORMAT);
        const endDate = moment(_date, DEFAULT_DATE_FORMAT)
            .startOf("day")
            .valueOf();
        const currentMonthStartDate = moment(month, "MMM YYYY")
            .startOf("month")
            .startOf("day")
            .valueOf();
        const currentMonthEndDate = moment(month, "MMM YYYY")
            .endOf("month")
            .startOf("day")
            .valueOf();
        const available = this.isDateAvailable(currentDate, minDate, maxDate, startDate, endDate, currentMonthStartDate, currentMonthEndDate, config);
        const inRange = this.isDateInRange(currentDate, minDate, maxDate, startDate, endDate, currentMonthStartDate, currentMonthEndDate, available, config);
        const active = this.isDateActive(currentDate, startDate, endDate, side);
        const today = this.isDateToday(currentDate, config);
        // Active
        if (currentDate === startDate && side === "left") {
            state.activeStartDate = date;
        }
        else if (currentDate === endDate && side === "right") {
            state.activeEndDate = date;
        }
        return { available, inRange, active, today };
    }
    getLabelProps(state, calendarType, side) {
        let label, labelFormat, type;
        if (calendarType === "daily") {
            label = `${state.selectedMonth[side]} ${state.selectedYear[side]}`;
            labelFormat = "MMM YYYY";
            type = "month";
        }
        else {
            label = `${state.selectedYear[side]}`;
            labelFormat = "YYYY";
            type = "year";
        }
        return { label, labelFormat, type };
    }
}
NgxDatetimeRangePickerService.Éµfac = function NgxDatetimeRangePickerService_Factory(t) { return new (t || NgxDatetimeRangePickerService)(); };
NgxDatetimeRangePickerService.Éµprov = i0.ÉµÉµdefineInjectable({ factory: function NgxDatetimeRangePickerService_Factory() { return new NgxDatetimeRangePickerService(); }, token: NgxDatetimeRangePickerService, providedIn: "root" });
/*@__PURE__*/ (function () { Éµngcc0.ÉµsetClassMetadata(NgxDatetimeRangePickerService, [{
        type: Injectable,
        args: [{
                providedIn: "root"
            }]
    }], null, null); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWRhdGV0aW1lLXJhbmdlLXBpY2tlci5zZXJ2aWNlLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9Vc2Vycy9iaGF2aW5wYXRlbC93b3Jrc3BhY2VzL3BlcnNvbmFsL25neC1kYXRldGltZS1yYW5nZS1waWNrZXIvcHJvamVjdHMvbmd4LWRhdGV0aW1lLXJhbmdlLXBpY2tlci9zcmMvbGliL25neC1kYXRldGltZS1yYW5nZS1waWNrZXIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFDTCxtQkFBbUIsRUFDbkIsK0JBQStCLElBQUksU0FBUyxFQUM3QyxNQUFNLHVDQUF1QyxDQUFDO0FBQy9DLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDMUYsT0FBTyxFQVVMLGFBQWEsRUFHZCxNQUFNLGNBQWMsQ0FBQztBQUN0Qjs7QUFHQSxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7QUFFakMsTUFBTSxtQkFBbUIsR0FBRyxTQUFTLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUMxRCxNQUFNLGdCQUFnQixHQUFHLFNBQVMsQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUM7QUFDN0QsTUFBTSxRQUFRLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7QUFDN0MsTUFBTSxjQUFjLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDaEQsTUFBTSxxQkFBcUIsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLHFCQUFxQixDQUFDO0FBS3ZFLE1BQU0sT0FBTyw2QkFBNkI7QUFDMUMsSUFBRSxpQkFBaUI7QUFBSyxRQUNwQixPQUFPLFNBQVMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBWSxDQUFDO0FBQzNE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VUFBVSxTQUFDO01BQ1YsVUFBVSxFQUFFLE1BQU07WUFDbkI7OzswQkFDSTtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQge1xuICBERUZBVUxUX0RBVEVfRk9STUFULFxuICBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzIGFzIENvbnN0YW50c1xufSBmcm9tIFwiLi9uZ3gtZGF0ZXRpbWUtcmFuZ2UtcGlja2VyLmNvbnN0YW50c1wiO1xuaW1wb3J0IHsgZ2V0Tm90QXZhaWxhYmxlVGV4dCwgY2xvbmVEZWVwLCBpc05pbCB9IGZyb20gXCIuL25neC1kYXRldGltZS1yYW5nZS1waWNrZXIudXRpbHNcIjtcbmltcG9ydCB7XG4gIE9wdGlvbnMsXG4gIFNldHRpbmdzLFxuICBDYWxlbmRhclNpZGVzLFxuICBTdGF0ZSxcbiAgUm93SXRlbVZhcmlhYmxlcyxcbiAgUm93SXRlbU9wdGlvbnMsXG4gIERhdGVDaGFyYWN0ZXJpc3RpY3MsXG4gIENvbmZpZyxcbiAgUm93T3B0aW9ucyxcbiAgQ2FsZW5kYXJUeXBlcyxcbiAgUm93VmFyaWFibGVzLFxuICBDYWxlbmRhclR5cGVcbn0gZnJvbSBcIi4vaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgTW9tZW50IH0gZnJvbSBcIm1vbWVudFwiO1xuXG5kZWNsYXJlIHZhciByZXF1aXJlOiBhbnk7XG5jb25zdCBtb21lbnQgPSByZXF1aXJlKFwibW9tZW50XCIpO1xuXG5jb25zdCBERUZBVUxUX1RJTUVfRk9STUFUID0gQ29uc3RhbnRzLkRFRkFVTFQuVElNRV9GT1JNQVQ7XG5jb25zdCBNT05USFNfQVZBSUxBQkxFID0gQ29uc3RhbnRzLkNPTlNUQU5ULk1PTlRIU19BVkFJTEFCTEU7XG5jb25zdCBUWl9OQU1FUyA9IENvbnN0YW50cy5DT05TVEFOVC5UWl9OQU1FUztcbmNvbnN0IERFRkFVTFRfUkFOR0VTID0gQ29uc3RhbnRzLkRFRkFVTFQuUkFOR0VTO1xuY29uc3QgTU9NRU5UX0NPTlZFUlNJT05fTUFQID0gQ29uc3RhbnRzLkNPTlNUQU5ULk1PTUVOVF9DT05WRVJTSU9OX01BUDtcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiBcInJvb3RcIlxufSlcbmV4cG9ydCBjbGFzcyBOZ3hEYXRldGltZVJhbmdlUGlja2VyU2VydmljZSB7XG4gIGdldERlZmF1bHRPcHRpb25zKCk6IE9wdGlvbnMge1xuICAgIHJldHVybiBjbG9uZURlZXAoQ29uc3RhbnRzLkRFRkFVTFQuT1BUSU9OUykgYXMgT3B0aW9ucztcbiAgfVxuXG4gIGdldERlZmF1bHRTZXR0aW5ncygpOiBTZXR0aW5ncyB7XG4gICAgcmV0dXJuIGNsb25lRGVlcChDb25zdGFudHMuREVGQVVMVC5TRVRUSU5HUykgYXMgU2V0dGluZ3M7XG4gIH1cblxuICBnZXREZWZhdWx0U3RhdGUoKTogU3RhdGUge1xuICAgIHJldHVybiBjbG9uZURlZXAoQ29uc3RhbnRzLkRFRkFVTFQuU1RBVEUpIGFzIFN0YXRlO1xuICB9XG5cbiAgY2hlY2tTZXR0aW5nc1ZhbGlkaXR5KHNldHRpbmdzOiBTZXR0aW5ncykge1xuICAgIGlmIChzZXR0aW5ncy50eXBlICYmICFDYWxlbmRhclR5cGVzLmluY2x1ZGVzKHNldHRpbmdzLnR5cGUgYXMgQ2FsZW5kYXJUeXBlKSkge1xuICAgICAgY29uc3QgZXJyTXNnID0gYCR7c2V0dGluZ3MudHlwZX0gaXMgYW4gaW52YWxpZCBjYWxlbmRhciB0eXBlLiBJdCBzaG91bGQgb25lIG9mICR7Wy4uLkNhbGVuZGFyVHlwZXNdfWA7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyTXNnKTtcbiAgICB9XG4gIH1cblxuICBmb3JtYXREYXRlVG9EZWZhdWx0Rm9ybWF0KGRhdGU6IHN0cmluZyB8IG51bWJlciwgZm9ybWF0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGxldCBmb3JtYXR0ZWREYXRlID0gbnVsbDtcbiAgICBpZiAoIWRhdGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWlzTmFOKE51bWJlcihkYXRlKSkpIHtcbiAgICAgIGZvcm1hdHRlZERhdGUgPSBtb21lbnQoZGF0ZSkuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3JtYXR0ZWREYXRlID0gbW9tZW50KGRhdGUsIGZvcm1hdCkuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIH1cblxuICAgIHJldHVybiBmb3JtYXR0ZWREYXRlO1xuICB9XG5cbiAgZm9ybWF0VGltZVRvRGVmYXVsdEZvcm1hdCh0aW1lOiBzdHJpbmcpIHtcbiAgICBsZXQgZm9ybWF0dGVkVGltZSA9IG51bGw7XG4gICAgaWYgKCF0aW1lKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRpbWUuaW5kZXhPZihcIjpcIikgPiAtMSkge1xuICAgICAgaWYgKHRpbWUuaW5kZXhPZihcIkFNXCIpID4gLTEgfHwgdGltZS5pbmRleE9mKFwiUE1cIikgPiAtMSkge1xuICAgICAgICBmb3JtYXR0ZWRUaW1lID0gbW9tZW50KHRpbWUsIFwiaDptbSBBXCIpLmZvcm1hdChERUZBVUxUX1RJTUVfRk9STUFUKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1hdHRlZFRpbWUgPSB0aW1lO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBXQVJOX05HWF9EQVRFVElNRV9SQU5HRV9QSUNLRVI6XG4gICAgICAgICAgICBUaGUgcHJvdmlkZWQgdGltZSBpcyBub3QgaW4gY29ycmVjdCBmb3JtYXQuXG4gICAgICAgICAgICBGb3JtYXQ6IEhIOm1tIG9yIGhoOm1tIEFcbiAgICAgICAgYFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGZvcm1hdHRlZFRpbWU7XG4gIH1cblxuICBnZXRDYWxlbmRhclJvd051bWJlclRleHQodHlwZSwgbnVtYmVyKSB7XG4gICAgcmV0dXJuICgoKSA9PiB7XG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcImRhaWx5XCI6XG4gICAgICAgICAgcmV0dXJuIGBXJHtudW1iZXJ9YDtcbiAgICAgICAgY2FzZSBcIndlZWtseVwiOlxuICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICBjYXNlIFwibW9udGhseVwiOlxuICAgICAgICAgIHJldHVybiBgUSR7bnVtYmVyfWA7XG4gICAgICAgIGNhc2UgXCJxdWFydGVybHlcIjpcbiAgICAgICAgICByZXR1cm4gYCR7bnVtYmVyfWA7XG4gICAgICAgIGNhc2UgXCJ5ZWFybHlcIjpcbiAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgIH1cbiAgICB9KSgpO1xuICB9XG5cbiAgY3JlYXRlRGVmYXVsdFJhbmdlcyhjb25maWc6IENvbmZpZyk6IE9iamVjdCB7XG4gICAgY29uc3QgcmFuZ2VzID0ge307XG4gICAgY29uc3QgdHlwZTogc3RyaW5nID0gY29uZmlnLnR5cGU7XG4gICAgY29uc3QgbWF4RGF0ZTogc3RyaW5nID0gY2xvbmVEZWVwKGNvbmZpZy5tYXhEYXRlKSBhcyBzdHJpbmc7XG5cbiAgICBERUZBVUxUX1JBTkdFU1t0eXBlXS5mb3JFYWNoKChyYW5nZUluZm86IHsgbGFiZWw6IHN0cmluZzsgY291bnQ6IG51bWJlciB9KSA9PiB7XG4gICAgICByYW5nZXNbcmFuZ2VJbmZvLmxhYmVsXSA9IHtcbiAgICAgICAgc3RhcnREYXRlOiBtb21lbnQobWF4RGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgICAgICAuc3VidHJhY3QocmFuZ2VJbmZvLmNvdW50LCBNT01FTlRfQ09OVkVSU0lPTl9NQVBbdHlwZV0pXG4gICAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRk9STUFUKSxcbiAgICAgICAgZW5kRGF0ZTogbWF4RGF0ZVxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIHJhbmdlc1tcIkN1c3RvbSBSYW5nZVwiXSA9IHsgc3RhcnREYXRlOiBudWxsLCBlbmREYXRlOiBudWxsIH07XG4gICAgcmV0dXJuIHJhbmdlcztcbiAgfVxuXG4gIGdldFNhbml0aXplZERhdGVBcnJheShjb25maWc6IENvbmZpZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzYW5pdGl6ZWREYXRlQXJyYXk6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgdHlwZSA9IGNvbmZpZy50eXBlO1xuICAgIGNvbnN0IGRhdGVBcnJheSA9IGNvbmZpZy5kYXRlQXJyYXk7XG4gICAgY29uc3QgaW5wdXREYXRlRm9ybWF0ID0gY29uZmlnLmlucHV0RGF0ZUZvcm1hdDtcblxuICAgIC8vIGRhdGVBcnJheSBjYW4gaGF2ZSBudWxsc1xuICAgIGRhdGVBcnJheS5mb3JFYWNoKChkYXRlKSA9PiB7XG4gICAgICBpZiAoIWRhdGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgZm9ybWF0OiBzdHJpbmcgPSBudWxsO1xuXG4gICAgICBpZiAoaXNOYU4oTnVtYmVyKGRhdGUpKSkge1xuICAgICAgICBpZiAoaW5wdXREYXRlRm9ybWF0KSB7XG4gICAgICAgICAgZm9ybWF0ID0gaW5wdXREYXRlRm9ybWF0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvcm1hdCA9IG1vbWVudChkYXRlKS5fZjsgLy8gbW9tZW50IGRvZXMgbm90IHN1cHBvcnQgdGhpc1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChpbnB1dERhdGVGb3JtYXQgIT09IG1vbWVudChkYXRlKS5fZikge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYEVSUl9OR1hfREFURVRJTUVfUkFOR0VfUElDS0VSOlxuICAgICAgICAgICAgICBpbnB1dERhdGVGb3JtYXQgIT09IGRhdGVGb3JtYXQgaW4gZGF0ZUFycmF5LlxuICAgICAgICAgICAgICBDb252ZXJ0ZWQgZGF0ZXMgbWlnaHQgbm90IGJlIGFzIGV4cGVjdGVkXG4gICAgICAgICAgICBgXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHZhbHVlOiBNb21lbnQgPSBmb3JtYXQgPyBtb21lbnQoZGF0ZSwgZm9ybWF0KSA6IG1vbWVudChkYXRlKTtcblxuICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZERhdGUgPSB2YWx1ZS5lbmRPZihNT01FTlRfQ09OVkVSU0lPTl9NQVBbdHlwZSBhcyBzdHJpbmddKS5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgICAgIHNhbml0aXplZERhdGVBcnJheS5wdXNoKGZvcm1hdHRlZERhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGBFUlJfTkdYX0RBVEVUSU1FX1JBTkdFX1BJQ0tFUjpcbiAgICAgICAgICAgICAgZGF0ZUFycmF5IHZhbHVlcyBhcmUgaW4gdW5rbm93biBmb3JtYXQuXG4gICAgICAgICAgICAgIFBhc3MgdGhlIGZvcm1hdCBvciBwYXNzIHRoZSBkYXRlcyBpbiBrbm93biBmb3JtYXRcbiAgICAgICAgICAgIGBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBbLi4ubmV3IFNldChzYW5pdGl6ZWREYXRlQXJyYXkpXTtcbiAgfVxuXG4gIGdldE51bWJlck9mV2Vla3MoZGF0ZSk6IG51bWJlciB7XG4gICAgaWYgKCFkYXRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbW9udGhTdGFydDogbnVtYmVyID0gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAuc3RhcnRPZihcIm1vbnRoXCIpXG4gICAgICAuZGF5KCk7XG4gICAgY29uc3QgbW9udGhFbmQ6IG51bWJlciA9IE51bWJlcihcbiAgICAgIG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKVxuICAgICAgICAuZW5kT2YoXCJtb250aFwiKVxuICAgICAgICAuZm9ybWF0KFwiRFwiKVxuICAgICk7XG4gICAgcmV0dXJuIE1hdGguY2VpbCgobW9udGhTdGFydCArIG1vbnRoRW5kKSAvIDcpO1xuICB9XG5cbiAgZ2V0WWVhcmx5V2Vla0NvdW50KHllYXI6IHN0cmluZyk6IG51bWJlciB7XG4gICAgaWYgKCF5ZWFyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgeWVhclN0YXJ0RGF0ZTogc3RyaW5nID0gbW9tZW50KHllYXIsIFwiWVlZWVwiKVxuICAgICAgLnN0YXJ0T2YoXCJ5ZWFyXCIpXG4gICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIGNvbnN0IHllYXJFbmREYXRlOiBzdHJpbmcgPSBtb21lbnQoeWVhciwgXCJZWVlZXCIpXG4gICAgICAuZW5kT2YoXCJ5ZWFyXCIpXG4gICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIGNvbnN0IHllYXJFbmRXZWVrRW5kRGF0ZTogc3RyaW5nID0gbW9tZW50KHllYXJFbmREYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKVxuICAgICAgLnN0YXJ0T2YoXCJ3ZWVrXCIpXG4gICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIGNvbnN0IHllYXJTdGFydFdlZWtFbmREYXRlOiBzdHJpbmcgPSBtb21lbnQoeWVhclN0YXJ0RGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgIC5lbmRPZihcIndlZWtcIilcbiAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG5cbiAgICBjb25zdCB5ZWFyU3RhcnRXZWVrTnVtYmVyOiBudW1iZXIgPSB0aGlzLmdldFdlZWtOdW1iZXIoeWVhclN0YXJ0V2Vla0VuZERhdGUpIGFzIG51bWJlcjtcbiAgICBjb25zdCB5ZWFyRW5kV2Vla051bWJlcjogbnVtYmVyID0gdGhpcy5nZXRXZWVrTnVtYmVyKHllYXJFbmRXZWVrRW5kRGF0ZSkgYXMgbnVtYmVyO1xuXG4gICAgcmV0dXJuIHllYXJFbmRXZWVrTnVtYmVyIC0geWVhclN0YXJ0V2Vla051bWJlciArIDE7XG4gIH1cblxuICBnZXRNb250aHNBdmFpbGFibGUobWluRGF0ZSwgbWF4RGF0ZSwgc2VsZWN0ZWRZZWFyKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IG1vbnRoczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmICghbWluRGF0ZSB8fCAhbWF4RGF0ZSB8fCAhc2VsZWN0ZWRZZWFyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbWluRGF0ZSA9IG1vbWVudChtaW5EYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKS5zdGFydE9mKFwibW9udGhcIik7XG4gICAgbWF4RGF0ZSA9IG1vbWVudChtYXhEYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKS5zdGFydE9mKFwibW9udGhcIik7XG5cbiAgICBsZXQgbWluRGF0ZW1zOiBudW1iZXIgPSBtb21lbnQobWluRGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVCkudmFsdWVPZigpO1xuICAgIGxldCBtYXhEYXRlbXM6IG51bWJlciA9IG1vbWVudChtYXhEYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKS52YWx1ZU9mKCk7XG4gICAgY29uc3QgeWVhclN0YXJ0bXM6IG51bWJlciA9IG1vbWVudCgpXG4gICAgICAueWVhcihzZWxlY3RlZFllYXIpXG4gICAgICAuc3RhcnRPZihcInllYXJcIilcbiAgICAgIC52YWx1ZU9mKCk7XG4gICAgY29uc3QgeWVhckVuZG1zOiBudW1iZXIgPSBtb21lbnQoKVxuICAgICAgLnllYXIoc2VsZWN0ZWRZZWFyKVxuICAgICAgLmVuZE9mKFwieWVhclwiKVxuICAgICAgLnZhbHVlT2YoKTtcblxuICAgIGlmIChtaW5EYXRlbXMgPCB5ZWFyU3RhcnRtcykge1xuICAgICAgbWluRGF0ZW1zID0geWVhclN0YXJ0bXM7XG4gICAgfVxuICAgIGlmIChtYXhEYXRlbXMgPiB5ZWFyRW5kbXMpIHtcbiAgICAgIG1heERhdGVtcyA9IHllYXJFbmRtcztcbiAgICB9XG5cbiAgICBsZXQgbWluRGF0ZU1vbnRoTnVtYmVyOiBudW1iZXIgPSBtb21lbnQobWluRGF0ZW1zKS5tb250aCgpO1xuICAgIGNvbnN0IGRpZmY6IG51bWJlciA9IG1vbWVudChtYXhEYXRlbXMpLmRpZmYobW9tZW50KG1pbkRhdGVtcyksIFwibW9udGhzXCIpO1xuICAgIGNvbnN0IG1heE1vbnRoczogbnVtYmVyID0gZGlmZiA8IE1PTlRIU19BVkFJTEFCTEUubGVuZ3RoID8gZGlmZiA6IE1PTlRIU19BVkFJTEFCTEUubGVuZ3RoO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbWF4TW9udGhzOyBpKyspIHtcbiAgICAgIGlmIChtaW5EYXRlTW9udGhOdW1iZXIgPj0gTU9OVEhTX0FWQUlMQUJMRS5sZW5ndGgpIHtcbiAgICAgICAgbW9udGhzLnB1c2goTU9OVEhTX0FWQUlMQUJMRVttaW5EYXRlTW9udGhOdW1iZXIgLSBNT05USFNfQVZBSUxBQkxFLmxlbmd0aF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbW9udGhzLnB1c2goTU9OVEhTX0FWQUlMQUJMRVttaW5EYXRlTW9udGhOdW1iZXJdKTtcbiAgICAgIH1cbiAgICAgIG1pbkRhdGVNb250aE51bWJlcisrO1xuICAgIH1cblxuICAgIHJldHVybiBtb250aHM7XG4gIH1cblxuICBnZXRZZWFyc0F2YWlsYWJsZShjb25maWc6IENvbmZpZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBtaW5EYXRlOiBzdHJpbmcgfCBudW1iZXIgPSBjb25maWcgPyBjb25maWcubWluRGF0ZSA6IFwiXCI7XG4gICAgY29uc3QgbWF4RGF0ZTogc3RyaW5nIHwgbnVtYmVyID0gY29uZmlnID8gY29uZmlnLm1heERhdGUgOiBcIlwiO1xuICAgIGNvbnN0IHllYXJzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKG1pbkRhdGUgJiYgbWF4RGF0ZSkge1xuICAgICAgY29uc3QgbWluWWVhcjogbnVtYmVyID0gTnVtYmVyKHRoaXMuZ2V0U2VsZWN0ZWRZZWFyKG1pbkRhdGUpKTtcbiAgICAgIGNvbnN0IG1heFllYXI6IG51bWJlciA9IE51bWJlcih0aGlzLmdldFNlbGVjdGVkWWVhcihtYXhEYXRlKSk7XG4gICAgICBjb25zdCBkaWZmID0gbWF4WWVhciAtIG1pblllYXI7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGRpZmY7IGkrKykge1xuICAgICAgICB5ZWFycy5wdXNoKGAke21pblllYXIgKyBpfWApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geWVhcnMucmV2ZXJzZSgpO1xuICB9XG5cbiAgaXNEYXRlQXZhaWxhYmxlKFxuICAgIGRhdGU6IG51bWJlcixcbiAgICBtaW5EYXRlOiBudW1iZXIsXG4gICAgbWF4RGF0ZTogbnVtYmVyLFxuICAgIHN0YXJ0RGF0ZTogbnVtYmVyLFxuICAgIGVuZERhdGU6IG51bWJlcixcbiAgICBtb250aFN0YXJ0RGF0ZTogbnVtYmVyLFxuICAgIG1vbnRoRW5kRGF0ZTogbnVtYmVyLFxuICAgIGNvbmZpZzogQ29uZmlnXG4gICk6IGJvb2xlYW4ge1xuICAgIGxldCBhdmFpbGFibGUgPSBmYWxzZTtcbiAgICBjb25zdCB0eXBlOiBzdHJpbmcgPSBjb25maWcudHlwZTtcbiAgICBjb25zdCBkaXNhYmxlV2Vla2VuZHM6IGJvb2xlYW4gPSBjb25maWcuZGlzYWJsZVdlZWtlbmRzO1xuICAgIGNvbnN0IGRpc2FibGVXZWVrZGF5czogYm9vbGVhbiA9IGNvbmZpZy5kaXNhYmxlV2Vla2RheXM7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICBtaW5EYXRlID0gbWluRGF0ZSA+IG1vbnRoU3RhcnREYXRlID8gbWluRGF0ZSA6IG1vbnRoU3RhcnREYXRlO1xuICAgICAgbWF4RGF0ZSA9IG1heERhdGUgPCBtb250aEVuZERhdGUgPyBtYXhEYXRlIDogbW9udGhFbmREYXRlO1xuICAgIH1cblxuICAgIGlmIChkYXRlID49IG1pbkRhdGUgJiYgZGF0ZSA8PSBtYXhEYXRlKSB7XG4gICAgICBhdmFpbGFibGUgPSB0cnVlO1xuXG4gICAgICBpZiAoYXZhaWxhYmxlKSB7XG4gICAgICAgIGlmIChkaXNhYmxlV2Vla2VuZHMpIHtcbiAgICAgICAgICBhdmFpbGFibGUgPSAhdGhpcy5pc1dlZWtlbmQoZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRpc2FibGVXZWVrZGF5cykge1xuICAgICAgICAgIGF2YWlsYWJsZSA9ICF0aGlzLmlzV2Vla2RheShkYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLmRhdGVBcnJheS5sZW5ndGgpIHtcbiAgICAgICAgICBhdmFpbGFibGUgPSB0aGlzLmlzSW5EYXRlQXJyYXkoZGF0ZSwgY29uZmlnLmRhdGVBcnJheSwgREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGF2YWlsYWJsZTtcbiAgfVxuXG4gIGlzRGF0ZUluUmFuZ2UoXG4gICAgZGF0ZTogbnVtYmVyLFxuICAgIG1pbkRhdGU6IG51bWJlcixcbiAgICBtYXhEYXRlOiBudW1iZXIsXG4gICAgc3RhcnREYXRlOiBudW1iZXIsXG4gICAgZW5kRGF0ZTogbnVtYmVyLFxuICAgIG1vbnRoU3RhcnREYXRlOiBudW1iZXIsXG4gICAgbW9udGhFbmREYXRlOiBudW1iZXIsXG4gICAgYXZhaWxhYmxlOiBib29sZWFuLFxuICAgIGNvbmZpZzogQ29uZmlnXG4gICk6IGJvb2xlYW4ge1xuICAgIGxldCBpblJhbmdlID0gZmFsc2U7XG4gICAgY29uc3QgdHlwZTogc3RyaW5nID0gY29uZmlnLnR5cGU7XG4gICAgY29uc3Qgc2luZ2xlRGF0ZVBpY2tlcjogYm9vbGVhbiA9IGNvbmZpZy5zaW5nbGVEYXRlUGlja2VyO1xuXG4gICAgaWYgKCFzaW5nbGVEYXRlUGlja2VyKSB7XG4gICAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICAgIG1pbkRhdGUgPSBtb250aFN0YXJ0RGF0ZTtcbiAgICAgICAgbWF4RGF0ZSA9IG1vbnRoRW5kRGF0ZTtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRlID49IHN0YXJ0RGF0ZSAmJiBkYXRlIDw9IGVuZERhdGUgJiYgZGF0ZSA+PSBtaW5EYXRlICYmIGRhdGUgPD0gbWF4RGF0ZSkge1xuICAgICAgICBpZiAoYXZhaWxhYmxlKSB7XG4gICAgICAgICAgaW5SYW5nZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluUmFuZ2U7XG4gIH1cblxuICBpc0RhdGVBY3RpdmUoZGF0ZTogbnVtYmVyLCBzdGFydERhdGU6IG51bWJlciwgZW5kRGF0ZTogbnVtYmVyLCBzaWRlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKGRhdGUgPT09IHN0YXJ0RGF0ZSAmJiBzaWRlID09PSBcImxlZnRcIikgfHwgKGRhdGUgPT09IGVuZERhdGUgJiYgc2lkZSA9PT0gXCJyaWdodFwiKTtcbiAgfVxuXG4gIGlzRGF0ZVRvZGF5KGRhdGVNczogbnVtYmVyLCBjb25maWcpOiBib29sZWFuIHtcbiAgICBjb25zdCB0b2RheURhdGU6IHN0cmluZyA9IG1vbWVudCgpLmZvcm1hdChERUZBVUxUX0RBVEVfRk9STUFUKTtcbiAgICBjb25zdCB0eXBlOiBzdHJpbmcgPSBjb25maWcudHlwZTtcbiAgICBjb25zdCB7IGZpcnN0RGF5LCBsYXN0RGF5IH0gPSB0aGlzLmdldEZpcnN0TGFzdERheSh0b2RheURhdGUsIHR5cGUpO1xuICAgIGNvbnN0IGZpcnN0RGF5TXM6IG51bWJlciA9IG1vbWVudChmaXJzdERheSwgREVGQVVMVF9EQVRFX0ZPUk1BVCkudmFsdWVPZigpO1xuICAgIGNvbnN0IGxhc3REYXlNczogbnVtYmVyID0gbW9tZW50KGxhc3REYXksIERFRkFVTFRfREFURV9GT1JNQVQpLnZhbHVlT2YoKTtcbiAgICByZXR1cm4gZGF0ZU1zID49IGZpcnN0RGF5TXMgJiYgZGF0ZU1zIDw9IGxhc3REYXlNcztcbiAgfVxuXG4gIGlzV2Vla2RheShkYXRlOiBudW1iZXIsIGZvcm1hdD86IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5pc1dlZWtlbmQoZGF0ZSwgZm9ybWF0KTtcbiAgfVxuXG4gIGlzV2Vla2VuZChkYXRlOiBudW1iZXIsIGZvcm1hdD86IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGlmICghZm9ybWF0KSB7XG4gICAgICBmb3JtYXQgPSBudWxsO1xuICAgIH1cbiAgICBjb25zdCBkYXkgPSBtb21lbnQoZGF0ZSwgZm9ybWF0KS5kYXkoKTtcbiAgICByZXR1cm4gZGF5ID09PSAwIHx8IGRheSA9PT0gNjtcbiAgfVxuXG4gIGlzSW5EYXRlQXJyYXkoZGF0ZTogbnVtYmVyLCBkYXRlQXJyYXk6IGFueVtdLCBmb3JtYXQ/OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoIWZvcm1hdCkge1xuICAgICAgZm9ybWF0ID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGVBcnJheS5maW5kKChkKSA9PiBtb21lbnQoZCwgZm9ybWF0KS52YWx1ZU9mKCkgPT09IGRhdGUpICE9PSB1bmRlZmluZWQ7XG4gIH1cblxuICBnZXRDYWxlbmRhclJvd1ZhcmlhYmxlcyhvcHRpb25zOiBSb3dPcHRpb25zKTogUm93VmFyaWFibGVzIHtcbiAgICBjb25zdCB2YXJpYWJsZXM6IFJvd1ZhcmlhYmxlcyA9IHtcbiAgICAgIHJvd051bWJlcjogXCJcIixcbiAgICAgIGNvbHVtbnM6IDBcbiAgICB9O1xuICAgIGNvbnN0IHR5cGU6IHN0cmluZyA9IG9wdGlvbnMudHlwZTtcbiAgICBjb25zdCBtb250aFN0YXJ0V2Vla051bWJlcjogbnVtYmVyID0gb3B0aW9ucy5tb250aFN0YXJ0V2Vla051bWJlcjtcbiAgICBjb25zdCBkYXRlUm93czogbnVtYmVyID0gb3B0aW9ucy5kYXRlUm93cztcbiAgICBjb25zdCB5ZWFyID0gYCR7b3B0aW9ucy55ZWFyfWA7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICB2YXJpYWJsZXMucm93TnVtYmVyID0gYCR7bW9udGhTdGFydFdlZWtOdW1iZXIgKyBkYXRlUm93c31gO1xuICAgICAgdmFyaWFibGVzLmNvbHVtbnMgPSA2O1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJ3ZWVrbHlcIikge1xuICAgICAgdmFyaWFibGVzLnJvd051bWJlciA9IGBgO1xuICAgICAgdmFyaWFibGVzLmNvbHVtbnMgPSA2O1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJtb250aGx5XCIpIHtcbiAgICAgIHZhcmlhYmxlcy5yb3dOdW1iZXIgPSBgJHtkYXRlUm93cyArIDF9YDtcbiAgICAgIHZhcmlhYmxlcy5jb2x1bW5zID0gMjtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwicXVhcnRlcmx5XCIpIHtcbiAgICAgIHZhcmlhYmxlcy5yb3dOdW1iZXIgPSB5ZWFyLmNoYXJBdChkYXRlUm93cyk7XG4gICAgICB2YXJpYWJsZXMuY29sdW1ucyA9IDA7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInllYXJseVwiKSB7XG4gICAgICB2YXJpYWJsZXMucm93TnVtYmVyID0gXCJcIjtcbiAgICAgIHZhcmlhYmxlcy5jb2x1bW5zID0gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFyaWFibGVzO1xuICB9XG5cbiAgZ2V0Q2FsZW5kYXJSb3dJdGVtVmFyaWFibGVzKG9wdGlvbnM6IFJvd0l0ZW1PcHRpb25zKTogUm93SXRlbVZhcmlhYmxlcyB7XG4gICAgY29uc3QgeyB0eXBlLCBtb250aFN0YXJ0V2Vla051bWJlciwgeWVhclN0YXJ0RGF0ZSwgeWVhciwgcm93SXRlbSwgZGF0ZVJvd3MsIGNvbHVtbnMgfSA9IG9wdGlvbnM7XG5cbiAgICBjb25zdCBpdGVtQ291bnQ6IG51bWJlciA9IHJvd0l0ZW0gKyBkYXRlUm93cyAqIGNvbHVtbnMgKyBkYXRlUm93cztcbiAgICBsZXQgY3VycmVudEl0ZW1EYXRlID0gXCJcIjtcbiAgICBsZXQgcm93SXRlbVRleHQgPSBcIlwiO1xuXG4gICAgaWYgKHR5cGUgPT09IFwiZGFpbHlcIikge1xuICAgICAgaWYgKCFpc05pbChtb250aFN0YXJ0V2Vla051bWJlcikgJiYgIWlzTmlsKGRhdGVSb3dzKSAmJiAhaXNOaWwoeWVhcikpIHtcbiAgICAgICAgY29uc3QgeWVhclN0YXJ0RGF0ZURhaWx5ID0gbW9tZW50KClcbiAgICAgICAgICAueWVhcih5ZWFyKVxuICAgICAgICAgIC5zdGFydE9mKFwieWVhclwiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgICAgIGN1cnJlbnRJdGVtRGF0ZSA9IG1vbWVudCh5ZWFyU3RhcnREYXRlRGFpbHksIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAgICAgLmFkZChtb250aFN0YXJ0V2Vla051bWJlciArIGRhdGVSb3dzIC0gMSwgXCJ3ZWVrXCIpXG4gICAgICAgICAgLnN0YXJ0T2YoXCJ3ZWVrXCIpXG4gICAgICAgICAgLmFkZChyb3dJdGVtLCBcImRheVwiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgICAgIHJvd0l0ZW1UZXh0ID0gbW9tZW50KGN1cnJlbnRJdGVtRGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVCkuZm9ybWF0KFwiRFwiKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwid2Vla2x5XCIpIHtcbiAgICAgIGlmICghaXNOaWwoeWVhclN0YXJ0RGF0ZSkgJiYgIWlzTmlsKGl0ZW1Db3VudCkpIHtcbiAgICAgICAgY3VycmVudEl0ZW1EYXRlID0gbW9tZW50KHllYXJTdGFydERhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAgICAgLmFkZChpdGVtQ291bnQsIFwid2Vla1wiKVxuICAgICAgICAgIC5lbmRPZihcIndlZWtcIilcbiAgICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgICAgICBjb25zdCB3ZWVrTnVtYmVyOiBhbnkgPSBpdGVtQ291bnQgKyAxO1xuICAgICAgICByb3dJdGVtVGV4dCA9IGBXJHt3ZWVrTnVtYmVyfWA7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vbnRobHlcIikge1xuICAgICAgaWYgKCFpc05pbChpdGVtQ291bnQpICYmICFpc05pbCh5ZWFyKSkge1xuICAgICAgICBjdXJyZW50SXRlbURhdGUgPSBtb21lbnQoKVxuICAgICAgICAgIC55ZWFyKHllYXIpXG4gICAgICAgICAgLm1vbnRoKGl0ZW1Db3VudClcbiAgICAgICAgICAuZW5kT2YoXCJtb250aFwiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgICAgIHJvd0l0ZW1UZXh0ID0gbW9tZW50KGN1cnJlbnRJdGVtRGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVCkuZm9ybWF0KFwiTU1NXCIpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJxdWFydGVybHlcIikge1xuICAgICAgaWYgKCFpc05pbChpdGVtQ291bnQpICYmICFpc05pbCh5ZWFyKSkge1xuICAgICAgICBjdXJyZW50SXRlbURhdGUgPSBtb21lbnQoKVxuICAgICAgICAgIC55ZWFyKHllYXIpXG4gICAgICAgICAgLnF1YXJ0ZXIoaXRlbUNvdW50ICsgMSlcbiAgICAgICAgICAuZW5kT2YoXCJxdWFydGVyXCIpXG4gICAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRk9STUFUKTtcbiAgICAgICAgcm93SXRlbVRleHQgPSBgUXVhcnRlciAke2l0ZW1Db3VudCArIDF9YDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB7IGZpcnN0RGF5LCBsYXN0RGF5IH0gPSB0aGlzLmdldEZpcnN0TGFzdERheShjdXJyZW50SXRlbURhdGUsIHR5cGUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGl0ZW1Db3VudCxcbiAgICAgIGN1cnJlbnRJdGVtRGF0ZSxcbiAgICAgIHJvd0l0ZW1UZXh0LFxuICAgICAgZmlyc3REYXksXG4gICAgICBsYXN0RGF5XG4gICAgfTtcbiAgfVxuXG4gIGlzUm93SWVtVmFsaWQob3B0aW9uczogUm93T3B0aW9ucyk6IGJvb2xlYW4ge1xuICAgIGxldCB2YWxpZCA9IGZhbHNlO1xuICAgIGNvbnN0IHR5cGU6IHN0cmluZyA9IG9wdGlvbnMudHlwZTtcbiAgICBjb25zdCB5ZWFyOiBzdHJpbmcgPSBvcHRpb25zLnllYXI7XG4gICAgY29uc3QgaXRlbUNvdW50OiBudW1iZXIgPSBvcHRpb25zLml0ZW1Db3VudDtcbiAgICBjb25zdCB2YWxpZFdlZWtDb3VudDogbnVtYmVyID0gdGhpcy5nZXRZZWFybHlXZWVrQ291bnQoeWVhcik7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICB2YWxpZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIndlZWtseVwiKSB7XG4gICAgICBpZiAoaXRlbUNvdW50IDwgdmFsaWRXZWVrQ291bnQpIHtcbiAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJtb250aGx5XCIpIHtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwicXVhcnRlcmx5XCIpIHtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsaWQ7XG4gIH1cblxuICBmb3JtYXRTdGFydERhdGUoY29uZmlnOiBDb25maWcsIHJldHVybkZvcm1hdDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBzdGFydERhdGU6IHN0cmluZyB8IG51bWJlciA9IGNvbmZpZyA/IGNvbmZpZy5zdGFydERhdGUgOiBudWxsO1xuICAgIGNvbnN0IHR5cGU6IHN0cmluZyA9IGNvbmZpZyA/IGNvbmZpZy50eXBlIDogXCJcIjtcbiAgICBsZXQgZm9ybWF0dGVkU3RhcnREYXRlOiBzdHJpbmcgPSBudWxsO1xuXG4gICAgaWYgKHN0YXJ0RGF0ZSkge1xuICAgICAgZm9ybWF0dGVkU3RhcnREYXRlID0gbW9tZW50KHN0YXJ0RGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgICAgLnN0YXJ0T2YoTU9NRU5UX0NPTlZFUlNJT05fTUFQW3R5cGVdKVxuICAgICAgICAuZm9ybWF0KHJldHVybkZvcm1hdCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvcm1hdHRlZFN0YXJ0RGF0ZTtcbiAgfVxuXG4gIGdldFNlbGVjdGVkWWVhcihkYXRlOiBzdHJpbmcgfCBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBtb21lbnQoZGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVCkuZm9ybWF0KFwiWVlZWVwiKTtcbiAgfVxuXG4gIGdldEZpcnN0TGFzdERheShkYXRlOiBzdHJpbmcsIHR5cGU6IHN0cmluZyk6IHsgZmlyc3REYXk6IHN0cmluZzsgbGFzdERheTogc3RyaW5nIH0ge1xuICAgIGxldCBmaXJzdERheSA9IFwiXCI7XG4gICAgbGV0IGxhc3REYXkgPSBcIlwiO1xuXG4gICAgaWYgKHR5cGUgPT09IFwiZGFpbHlcIikge1xuICAgICAgZmlyc3REYXkgPSBsYXN0RGF5ID0gZGF0ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwid2Vla2x5XCIpIHtcbiAgICAgIGZpcnN0RGF5ID0gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAgIC5zdGFydE9mKFwid2Vla1wiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgICAgbGFzdERheSA9IG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKVxuICAgICAgICAuZW5kT2YoXCJ3ZWVrXCIpXG4gICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vbnRobHlcIikge1xuICAgICAgZmlyc3REYXkgPSBtb21lbnQoZGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgICAgLnN0YXJ0T2YoXCJtb250aFwiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgICAgbGFzdERheSA9IG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKVxuICAgICAgICAuZW5kT2YoXCJtb250aFwiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJxdWFydGVybHlcIikge1xuICAgICAgZmlyc3REYXkgPSBtb21lbnQoZGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgICAgLnN0YXJ0T2YoXCJxdWFydGVyXCIpXG4gICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgICBsYXN0RGF5ID0gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAgIC5lbmRPZihcInF1YXJ0ZXJcIilcbiAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRk9STUFUKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwieWVhcmx5XCIpIHtcbiAgICAgIGZpcnN0RGF5ID0gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAgIC5zdGFydE9mKFwieWVhclwiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgICAgbGFzdERheSA9IG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKVxuICAgICAgICAuZW5kT2YoXCJ5ZWFyXCIpXG4gICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZmlyc3REYXksIGxhc3REYXkgfTtcbiAgfVxuXG4gIGdldFpvbmVEYXRlKHR6OiBzdHJpbmcsIGZvcm1hdDogc3RyaW5nLCBkYXRlPzogc3RyaW5nKTogTW9tZW50IHtcbiAgICBsZXQgX2RhdGU6IG51bWJlciA9IG1vbWVudCgpLnZhbHVlT2YoKTtcblxuICAgIGlmIChkYXRlKSB7XG4gICAgICBfZGF0ZSA9IG1vbWVudChkYXRlLCBmb3JtYXQpXG4gICAgICAgIC5zdGFydE9mKFwiZGF5XCIpXG4gICAgICAgIC52YWx1ZU9mKCk7XG4gICAgfVxuXG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZShfZGF0ZSkudG9Mb2NhbGVTdHJpbmcoXCJlbi1VU1wiLCB7XG4gICAgICB0aW1lWm9uZTogVFpfTkFNRVNbdHpdXG4gICAgfSk7XG5cbiAgICByZXR1cm4gbW9tZW50KHRvZGF5LCBcIk1NL0REL1lZWVksIGhoOm1tOnNzIEFcIik7XG4gIH1cblxuICBnZXRab25lVG9kYXkodHo6IHN0cmluZywgdmlld0RhdGVGb3JtYXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgdG9kYXk6IE1vbWVudCA9IHRoaXMuZ2V0Wm9uZURhdGUodHosIHZpZXdEYXRlRm9ybWF0KTtcbiAgICByZXR1cm4gbW9tZW50KHRvZGF5KS5mb3JtYXQoYCR7dmlld0RhdGVGb3JtYXR9ICBoaDptbSBBYCk7XG4gIH1cblxuICBmb3JtYXRUb1pvbmVEYXRlKHR6OiBzdHJpbmcsIGZvcm1hdDogc3RyaW5nLCBkYXRlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGZvcm1hdHRlZERhdGU6IE1vbWVudCA9IHRoaXMuZ2V0Wm9uZURhdGUodHosIGZvcm1hdCwgZGF0ZSk7XG4gICAgcmV0dXJuIG1vbWVudChmb3JtYXR0ZWREYXRlKS5mb3JtYXQoYCR7Zm9ybWF0fWApO1xuICB9XG5cbiAgY29udmVydFRvVmlld1RpbWVJdGVtKGl0ZW06IHN0cmluZyB8IG51bWJlcik6IHN0cmluZyB7XG4gICAgbGV0IHN0cmluZ2lmaWVkX2l0ZW0gPSBpdGVtICsgXCJcIjtcbiAgICBpZiAoc3RyaW5naWZpZWRfaXRlbS5sZW5ndGggPT09IDEpIHtcbiAgICAgIHN0cmluZ2lmaWVkX2l0ZW0gPSBgMCR7c3RyaW5naWZpZWRfaXRlbX1gO1xuICAgIH1cbiAgICByZXR1cm4gc3RyaW5naWZpZWRfaXRlbTtcbiAgfVxuXG4gIGdldFdlZWtOdW1iZXIoZGF0ZTogc3RyaW5nKTogc3RyaW5nIHwgbnVtYmVyIHtcbiAgICBpZiAoZGF0ZSkge1xuICAgICAgY29uc3QgeWVhcjogbnVtYmVyID0gbW9tZW50KGRhdGUsIFwiWVlZWS1NTS1ERFwiKS55ZWFyKCk7XG4gICAgICBjb25zdCBtb250aDogbnVtYmVyID0gbW9tZW50KGRhdGUsIFwiWVlZWS1NTS1ERFwiKS5tb250aCgpO1xuICAgICAgY29uc3QgZGF5OiBudW1iZXIgPSBOdW1iZXIobW9tZW50KGRhdGUsIFwiWVlZWS1NTS1ERFwiKS5mb3JtYXQoXCJEXCIpKTtcblxuICAgICAgY29uc3QgeWVhclN0YXJ0bXM6IERhdGUgPSBuZXcgRGF0ZSh5ZWFyLCAwLCAxKTtcbiAgICAgIGNvbnN0IGRhdGVtczogRGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpO1xuICAgICAgcmV0dXJuIE1hdGguY2VpbCgoKGRhdGVtcy5nZXRUaW1lKCkgLSB5ZWFyU3RhcnRtcy5nZXRUaW1lKCkpIC8gODY0MDAwMDAgKyB5ZWFyU3RhcnRtcy5nZXREYXkoKSArIDEpIC8gNyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2FybihgXG4gICAgICAgIFdBUk5fTkdYX0RBVEVUSU1FX1JBTkdFX1BJQ0tFUiB8IGdldFdlZWtOdW1iZXI6XG4gICAgICAgIEludmFsaWQgZGF0ZVxuICAgICAgYCk7XG4gICAgICByZXR1cm4gZ2V0Tm90QXZhaWxhYmxlVGV4dCgpO1xuICAgIH1cbiAgfVxuXG4gIGl0ZXJhdGVPdmVyRGF0ZU9iaihkYXRlczogQ2FsZW5kYXJTaWRlcywgZnVuYykge1xuICAgIGZvciAoY29uc3Qgc2lkZSBpbiBkYXRlcykge1xuICAgICAgaWYgKHNpZGUpIHtcbiAgICAgICAgY29uc3Qgc2lkZURhdGVzID0gZGF0ZXNbc2lkZV07XG4gICAgICAgIHNpZGVEYXRlcy5pdGVtUm93cy5mb3JFYWNoKChyb3dzKSA9PiB7XG4gICAgICAgICAgcm93cy5pdGVtcy5mb3JFYWNoKChyb3dJdGVtKSA9PiB7XG4gICAgICAgICAgICBmdW5jKHJvd0l0ZW0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRDYWxlbmRhckNvbHNwYW4odHlwZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICByZXR1cm4gNjtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwid2Vla2x5XCIpIHtcbiAgICAgIHJldHVybiA4O1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJtb250aGx5XCIpIHtcbiAgICAgIHJldHVybiAzO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJxdWFydGVybHlcIikge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInllYXJseVwiKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG4gIH1cblxuICBnZXRDYWxlbmRhclJvd0l0ZW1Db2xzcGFuKHR5cGU6IHN0cmluZyk6IG51bWJlciB7XG4gICAgaWYgKHR5cGUgPT09IFwibW9udGhseVwiKSB7XG4gICAgICByZXR1cm4gMztcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwicXVhcnRlcmx5XCIpIHtcbiAgICAgIHJldHVybiA2O1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJ5ZWFybHlcIikge1xuICAgICAgcmV0dXJuIDY7XG4gICAgfVxuICB9XG5cbiAgZ2V0RGF0ZUNoYXJhY3RlcmlzdGljcyhjb25maWc6IENvbmZpZywgc3RhdGU6IFN0YXRlLCBkYXRlOiBzdHJpbmcsIG1vbnRoOiBzdHJpbmcsIHNpZGU6IHN0cmluZyk6IERhdGVDaGFyYWN0ZXJpc3RpY3Mge1xuICAgIGNvbnN0IGN1cnJlbnREYXRlOiBudW1iZXIgPSBtb21lbnQoZGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgIC5zdGFydE9mKFwiZGF5XCIpXG4gICAgICAudmFsdWVPZigpO1xuXG4gICAgbGV0IF9kYXRlOiBzdHJpbmcgPSB0aGlzLmZvcm1hdERhdGVUb0RlZmF1bHRGb3JtYXQoY29uZmlnLm1pbkRhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIGNvbnN0IG1pbkRhdGU6IG51bWJlciA9IG1vbWVudChfZGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgIC5zdGFydE9mKFwiZGF5XCIpXG4gICAgICAudmFsdWVPZigpO1xuXG4gICAgX2RhdGUgPSB0aGlzLmZvcm1hdERhdGVUb0RlZmF1bHRGb3JtYXQoY29uZmlnLm1heERhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpO1xuICAgIGNvbnN0IG1heERhdGU6IG51bWJlciA9IG1vbWVudChfZGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVClcbiAgICAgIC5zdGFydE9mKFwiZGF5XCIpXG4gICAgICAudmFsdWVPZigpO1xuXG4gICAgX2RhdGUgPSB0aGlzLmZvcm1hdERhdGVUb0RlZmF1bHRGb3JtYXQoY29uZmlnLnN0YXJ0RGF0ZSwgREVGQVVMVF9EQVRFX0ZPUk1BVCk7XG4gICAgY29uc3Qgc3RhcnREYXRlOiBudW1iZXIgPSBtb21lbnQoX2RhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAuc3RhcnRPZihcImRheVwiKVxuICAgICAgLnZhbHVlT2YoKTtcblxuICAgIF9kYXRlID0gdGhpcy5mb3JtYXREYXRlVG9EZWZhdWx0Rm9ybWF0KGNvbmZpZy5lbmREYXRlLCBERUZBVUxUX0RBVEVfRk9STUFUKTtcbiAgICBjb25zdCBlbmREYXRlOiBudW1iZXIgPSBtb21lbnQoX2RhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpXG4gICAgICAuc3RhcnRPZihcImRheVwiKVxuICAgICAgLnZhbHVlT2YoKTtcblxuICAgIGNvbnN0IGN1cnJlbnRNb250aFN0YXJ0RGF0ZTogbnVtYmVyID0gbW9tZW50KG1vbnRoLCBcIk1NTSBZWVlZXCIpXG4gICAgICAuc3RhcnRPZihcIm1vbnRoXCIpXG4gICAgICAuc3RhcnRPZihcImRheVwiKVxuICAgICAgLnZhbHVlT2YoKTtcbiAgICBjb25zdCBjdXJyZW50TW9udGhFbmREYXRlOiBudW1iZXIgPSBtb21lbnQobW9udGgsIFwiTU1NIFlZWVlcIilcbiAgICAgIC5lbmRPZihcIm1vbnRoXCIpXG4gICAgICAuc3RhcnRPZihcImRheVwiKVxuICAgICAgLnZhbHVlT2YoKTtcblxuICAgIGNvbnN0IGF2YWlsYWJsZTogYm9vbGVhbiA9IHRoaXMuaXNEYXRlQXZhaWxhYmxlKFxuICAgICAgY3VycmVudERhdGUsXG4gICAgICBtaW5EYXRlLFxuICAgICAgbWF4RGF0ZSxcbiAgICAgIHN0YXJ0RGF0ZSxcbiAgICAgIGVuZERhdGUsXG4gICAgICBjdXJyZW50TW9udGhTdGFydERhdGUsXG4gICAgICBjdXJyZW50TW9udGhFbmREYXRlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgICBjb25zdCBpblJhbmdlOiBib29sZWFuID0gdGhpcy5pc0RhdGVJblJhbmdlKFxuICAgICAgY3VycmVudERhdGUsXG4gICAgICBtaW5EYXRlLFxuICAgICAgbWF4RGF0ZSxcbiAgICAgIHN0YXJ0RGF0ZSxcbiAgICAgIGVuZERhdGUsXG4gICAgICBjdXJyZW50TW9udGhTdGFydERhdGUsXG4gICAgICBjdXJyZW50TW9udGhFbmREYXRlLFxuICAgICAgYXZhaWxhYmxlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgICBjb25zdCBhY3RpdmU6IGJvb2xlYW4gPSB0aGlzLmlzRGF0ZUFjdGl2ZShjdXJyZW50RGF0ZSwgc3RhcnREYXRlLCBlbmREYXRlLCBzaWRlKTtcbiAgICBjb25zdCB0b2RheTogYm9vbGVhbiA9IHRoaXMuaXNEYXRlVG9kYXkoY3VycmVudERhdGUsIGNvbmZpZyk7XG5cbiAgICAvLyBBY3RpdmVcbiAgICBpZiAoY3VycmVudERhdGUgPT09IHN0YXJ0RGF0ZSAmJiBzaWRlID09PSBcImxlZnRcIikge1xuICAgICAgc3RhdGUuYWN0aXZlU3RhcnREYXRlID0gZGF0ZTtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnREYXRlID09PSBlbmREYXRlICYmIHNpZGUgPT09IFwicmlnaHRcIikge1xuICAgICAgc3RhdGUuYWN0aXZlRW5kRGF0ZSA9IGRhdGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgYXZhaWxhYmxlLCBpblJhbmdlLCBhY3RpdmUsIHRvZGF5IH07XG4gIH1cblxuICBnZXRMYWJlbFByb3BzKFxuICAgIHN0YXRlOiBTdGF0ZSxcbiAgICBjYWxlbmRhclR5cGU6IHN0cmluZyxcbiAgICBzaWRlOiBzdHJpbmdcbiAgKTogeyBsYWJlbDogc3RyaW5nOyBsYWJlbEZvcm1hdDogc3RyaW5nOyB0eXBlOiBzdHJpbmcgfSB7XG4gICAgbGV0IGxhYmVsOiBzdHJpbmcsIGxhYmVsRm9ybWF0OiBzdHJpbmcsIHR5cGU6IHN0cmluZztcblxuICAgIGlmIChjYWxlbmRhclR5cGUgPT09IFwiZGFpbHlcIikge1xuICAgICAgbGFiZWwgPSBgJHtzdGF0ZS5zZWxlY3RlZE1vbnRoW3NpZGVdfSAke3N0YXRlLnNlbGVjdGVkWWVhcltzaWRlXX1gO1xuICAgICAgbGFiZWxGb3JtYXQgPSBcIk1NTSBZWVlZXCI7XG4gICAgICB0eXBlID0gXCJtb250aFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBsYWJlbCA9IGAke3N0YXRlLnNlbGVjdGVkWWVhcltzaWRlXX1gO1xuICAgICAgbGFiZWxGb3JtYXQgPSBcIllZWVlcIjtcbiAgICAgIHR5cGUgPSBcInllYXJcIjtcbiAgICB9XG5cbiAgICByZXR1cm4geyBsYWJlbCwgbGFiZWxGb3JtYXQsIHR5cGUgfTtcbiAgfVxufVxuIl19